{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 121, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/conni/Documents/Pathway/handcrafted-haven/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from \"@prisma/client\";\r\n\r\nconst globalForPrisma = globalThis as unknown as { prisma?: PrismaClient };\r\n\r\nexport const prisma =\r\n  globalForPrisma.prisma ??\r\n  new PrismaClient({\r\n    // log: [\"query\", \"info\", \"warn\", \"error\"],\r\n  });\r\n\r\nif (process.env.NODE_ENV !== \"production\") {\r\n  globalForPrisma.prisma = prisma;\r\n}"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,kBAAkB;AAEjB,MAAM,SACX,gBAAgB,MAAM,IACtB,IAAI,6IAAY,CAAC;AAEjB;AAEF,wCAA2C;IACzC,gBAAgB,MAAM,GAAG;AAC3B","debugId":null}},
    {"offset": {"line": 137, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/conni/Documents/Pathway/handcrafted-haven/app/api/auth/%5B...nextauth%5D/route.ts"],"sourcesContent":["import NextAuth, { type NextAuthOptions } from \"next-auth\";\r\nimport Credentials from \"next-auth/providers/credentials\";\r\nimport { PrismaAdapter } from \"@auth/prisma-adapter\";\r\nimport { prisma } from \"@/lib/prisma\";\r\nimport bcrypt from \"bcryptjs\";\r\n\r\nexport const authOptions: NextAuthOptions = {\r\n  adapter: PrismaAdapter(prisma),\r\n  session: { strategy: \"jwt\" },\r\n  providers: [\r\n    Credentials({\r\n      name: \"Credentials\",\r\n      credentials: { email: {}, password: {} },\r\n      async authorize(creds) {\r\n        if (!creds?.email || !creds?.password) return null;\r\n        const user = await prisma.user.findUnique({\r\n          where: { email: creds.email },\r\n          include: { artisan: true },\r\n        });\r\n        if (!user) return null;\r\n        const ok = await bcrypt.compare(creds.password, user.password);\r\n        if (!ok) return null;\r\n        return {\r\n          id: user.id,\r\n          email: user.email,\r\n          name: user.name ?? user.artisan?.displayName ?? \"Artisan\",\r\n          artisanSlug: user.artisan?.slug,\r\n        };\r\n      },\r\n    }),\r\n  ],\r\n  callbacks: {\r\n    async jwt({ token, user }) {\r\n      if (user) {\r\n        token.userId = (user as any).id;\r\n        token.artisanSlug = (user as any).artisanSlug;\r\n      }\r\n      return token;\r\n    },\r\n    async session({ session, token }) {\r\n      session.userId = token.userId as string;\r\n      session.artisanSlug = token.artisanSlug as string;\r\n      if (session.user) session.user.artisanSlug = token.artisanSlug as string;\r\n      return session;\r\n    },\r\n  },\r\n};\r\n\r\nconst handler = NextAuth(authOptions);\r\nexport { handler as GET, handler as POST };"],"names":[],"mappings":";;;;;;;;AAAA;AACA;AACA;AACA;AACA;;;;;;AAEO,MAAM,cAA+B;IAC1C,SAAS,IAAA,iRAAa,EAAC,yHAAM;IAC7B,SAAS;QAAE,UAAU;IAAM;IAC3B,WAAW;QACT,IAAA,iRAAW,EAAC;YACV,MAAM;YACN,aAAa;gBAAE,OAAO,CAAC;gBAAG,UAAU,CAAC;YAAE;YACvC,MAAM,WAAU,KAAK;gBACnB,IAAI,CAAC,OAAO,SAAS,CAAC,OAAO,UAAU,OAAO;gBAC9C,MAAM,OAAO,MAAM,yHAAM,CAAC,IAAI,CAAC,UAAU,CAAC;oBACxC,OAAO;wBAAE,OAAO,MAAM,KAAK;oBAAC;oBAC5B,SAAS;wBAAE,SAAS;oBAAK;gBAC3B;gBACA,IAAI,CAAC,MAAM,OAAO;gBAClB,MAAM,KAAK,MAAM,mMAAM,CAAC,OAAO,CAAC,MAAM,QAAQ,EAAE,KAAK,QAAQ;gBAC7D,IAAI,CAAC,IAAI,OAAO;gBAChB,OAAO;oBACL,IAAI,KAAK,EAAE;oBACX,OAAO,KAAK,KAAK;oBACjB,MAAM,KAAK,IAAI,IAAI,KAAK,OAAO,EAAE,eAAe;oBAChD,aAAa,KAAK,OAAO,EAAE;gBAC7B;YACF;QACF;KACD;IACD,WAAW;QACT,MAAM,KAAI,EAAE,KAAK,EAAE,IAAI,EAAE;YACvB,IAAI,MAAM;gBACR,MAAM,MAAM,GAAG,AAAC,KAAa,EAAE;gBAC/B,MAAM,WAAW,GAAG,AAAC,KAAa,WAAW;YAC/C;YACA,OAAO;QACT;QACA,MAAM,SAAQ,EAAE,OAAO,EAAE,KAAK,EAAE;YAC9B,QAAQ,MAAM,GAAG,MAAM,MAAM;YAC7B,QAAQ,WAAW,GAAG,MAAM,WAAW;YACvC,IAAI,QAAQ,IAAI,EAAE,QAAQ,IAAI,CAAC,WAAW,GAAG,MAAM,WAAW;YAC9D,OAAO;QACT;IACF;AACF;AAEA,MAAM,UAAU,IAAA,8PAAQ,EAAC","debugId":null}},
    {"offset": {"line": 211, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/conni/Documents/Pathway/handcrafted-haven/app/api/products/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\r\nimport { getServerSession } from \"next-auth\";\r\nimport { authOptions } from \"@/app/api/auth/[...nextauth]/route\";\r\nimport { prisma } from \"@/lib/prisma\";\r\n\r\nexport const runtime = \"nodejs\";\r\nexport const dynamic = \"force-dynamic\";\r\n\r\nexport async function GET() {\r\n  try {\r\n    const items = await prisma.product.findMany({\r\n      orderBy: { createdAt: \"desc\" },\r\n      include: { ArtisanProfile: { select: { slug: true, displayName: true } } },\r\n    });\r\n    return NextResponse.json(items);\r\n  } catch (e: any) {\r\n    console.error(\"GET /api/products error:\", e);\r\n    return NextResponse.json({ error: \"Failed to load products\" }, { status: 500 });\r\n  }\r\n}\r\n\r\nexport async function POST(req: Request) {\r\n  try {\r\n\r\n    const session = await getServerSession(authOptions);\r\n    if (!session?.user?.email) {\r\n      return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 });\r\n    }\r\n\r\n    const { name, description, price, imageUrl, brand, category } = await req.json();\r\n\r\n    if (!name || imageUrl == null || imageUrl === \"\" || price == null || price === \"\") {\r\n      return NextResponse.json({ error: \"Missing required fields\" }, { status: 400 });\r\n    }\r\n\r\n    const priceNumber = typeof price === \"number\" ? price : parseFloat(String(price));\r\n    if (Number.isNaN(priceNumber) || priceNumber < 0) {\r\n      return NextResponse.json({ error: \"Invalid price\" }, { status: 400 });\r\n    }\r\n    const priceCents = Math.round(priceNumber * 100);\r\n\r\n    const user = await prisma.user.findUnique({\r\n      where: { email: session.user.email! },\r\n      include: { artisan: true },\r\n    });\r\n    if (!user?.artisan) {\r\n      return NextResponse.json({ error: \"No artisan profile for this account\" }, { status: 400 });\r\n    }\r\n\r\n    const created = await prisma.product.create({\r\n      data: {\r\n        name,\r\n        description: description ?? null,\r\n        priceCents,\r\n        imageUrl,\r\n        brand: brand ?? null,\r\n        category: category ?? null,\r\n        artisanId: user.artisan.id,\r\n      },\r\n    });\r\n\r\n    return NextResponse.json(created, { status: 201 });\r\n  } catch (e: any) {\r\n\r\n    console.error(\"POST /api/products error:\", e);\r\n    return NextResponse.json({ error: e?.message ?? \"Failed to create product\" }, { status: 500 });\r\n  }\r\n}"],"names":[],"mappings":";;;;;;;;;;AAAA;AACA;AACA;AACA;;;;;AAEO,MAAM,UAAU;AAChB,MAAM,UAAU;AAEhB,eAAe;IACpB,IAAI;QACF,MAAM,QAAQ,MAAM,yHAAM,CAAC,OAAO,CAAC,QAAQ,CAAC;YAC1C,SAAS;gBAAE,WAAW;YAAO;YAC7B,SAAS;gBAAE,gBAAgB;oBAAE,QAAQ;wBAAE,MAAM;wBAAM,aAAa;oBAAK;gBAAE;YAAE;QAC3E;QACA,OAAO,+QAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,GAAQ;QACf,QAAQ,KAAK,CAAC,4BAA4B;QAC1C,OAAO,+QAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAA0B,GAAG;YAAE,QAAQ;QAAI;IAC/E;AACF;AAEO,eAAe,KAAK,GAAY;IACrC,IAAI;QAEF,MAAM,UAAU,MAAM,IAAA,uQAAgB,EAAC,kKAAW;QAClD,IAAI,CAAC,SAAS,MAAM,OAAO;YACzB,OAAO,+QAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAe,GAAG;gBAAE,QAAQ;YAAI;QACpE;QAEA,MAAM,EAAE,IAAI,EAAE,WAAW,EAAE,KAAK,EAAE,QAAQ,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,MAAM,IAAI,IAAI;QAE9E,IAAI,CAAC,QAAQ,YAAY,QAAQ,aAAa,MAAM,SAAS,QAAQ,UAAU,IAAI;YACjF,OAAO,+QAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAA0B,GAAG;gBAAE,QAAQ;YAAI;QAC/E;QAEA,MAAM,cAAc,OAAO,UAAU,WAAW,QAAQ,WAAW,OAAO;QAC1E,IAAI,OAAO,KAAK,CAAC,gBAAgB,cAAc,GAAG;YAChD,OAAO,+QAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAgB,GAAG;gBAAE,QAAQ;YAAI;QACrE;QACA,MAAM,aAAa,KAAK,KAAK,CAAC,cAAc;QAE5C,MAAM,OAAO,MAAM,yHAAM,CAAC,IAAI,CAAC,UAAU,CAAC;YACxC,OAAO;gBAAE,OAAO,QAAQ,IAAI,CAAC,KAAK;YAAE;YACpC,SAAS;gBAAE,SAAS;YAAK;QAC3B;QACA,IAAI,CAAC,MAAM,SAAS;YAClB,OAAO,+QAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAsC,GAAG;gBAAE,QAAQ;YAAI;QAC3F;QAEA,MAAM,UAAU,MAAM,yHAAM,CAAC,OAAO,CAAC,MAAM,CAAC;YAC1C,MAAM;gBACJ;gBACA,aAAa,eAAe;gBAC5B;gBACA;gBACA,OAAO,SAAS;gBAChB,UAAU,YAAY;gBACtB,WAAW,KAAK,OAAO,CAAC,EAAE;YAC5B;QACF;QAEA,OAAO,+QAAY,CAAC,IAAI,CAAC,SAAS;YAAE,QAAQ;QAAI;IAClD,EAAE,OAAO,GAAQ;QAEf,QAAQ,KAAK,CAAC,6BAA6B;QAC3C,OAAO,+QAAY,CAAC,IAAI,CAAC;YAAE,OAAO,GAAG,WAAW;QAA2B,GAAG;YAAE,QAAQ;QAAI;IAC9F;AACF","debugId":null}}]
}